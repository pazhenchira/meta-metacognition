# Application Orchestration Plan

**Application**: [APP_NAME]  
**Meta-Orchestrator Version**: [VERSION]  
**Generated**: [DATE]  
**Status**: [IN_PROGRESS | COMPLETE]

---

## 1. Application Overview

**Purpose**: [Brief description from app_intent.md]

**Domain**: [e.g., Finance, Healthcare, E-commerce, Data Pipeline, etc.]

**Risk Level**: [CRITICAL | HIGH | MEDIUM | LOW]

**Complexity Score**: [0.0 - 1.0] (based on number of LEGOs, external dependencies, data sensitivity)

**System-of-Systems**: [YES | NO]

**Coordination Mode**: [standalone | federated | tracked | governed]

**Repo Graph Summary**: [list repos and dependencies if applicable]

---

## 2. LEGO Architecture

### 2.1 LEGO Breakdown

Total LEGOs: [N]

| LEGO Name | Type | Responsibility | Risk Level | Dependencies | Confidence |
|-----------|------|---------------|------------|--------------|------------|
| config_validator | config_validation | Validate configuration and guide setup | CRITICAL | (none) | 0.95 |
| [lego_name] | implementation | [single responsibility] | [CRITICAL/HIGH/MEDIUM/LOW] | [lego1, lego2] | [0.0-1.0] |
| ... | ... | ... | ... | ... | ... |

### 2.2 Dependency Graph

```
config_validator (Priority: CRITICAL)
    ↓
auth → session → api_gateway → [other LEGOs]
    ↓       ↓           ↓
logging  logging   logging
    ↓       ↓           ↓
        database
```

**Critical Path**: [config_validator → LEGO1 → LEGO2 → ...]

**Parallelizable Groups**:
- Group A: [lego1, lego2, lego3] (no dependencies)
- Group B: [lego4, lego5] (depend on Group A)

### 2.3 LEGO Details

#### LEGO: [name]

**Type**: [implementation | integration_test | system_test | config_validation]

**Responsibility**: [single responsibility description]

**Risk Assessment**:
- Risk Level: [CRITICAL | HIGH | MEDIUM | LOW]
- Rationale: [why this risk level]
- Sensitive Data: [YES/NO] - [PII, PHI, payment data, credentials, etc.]

**Inputs**:
- [input1]: [description]
- [input2]: [description]

**Outputs**:
- [output1]: [description]
- [output2]: [description]

**Confidence Score**: [0.0 - 1.0]
- Domain Knowledge: [0.0 - 1.0]
- Requirements Clarity: [0.0 - 1.0]
- Precedent Match: [0.0 - 1.0]
- Risk Level: [CRITICAL | HIGH | MEDIUM | LOW]

**Wisdom Applied**:
- [Principle #N: Description]
- [Principle #N: Description]

**Antipatterns Avoided**:
- [Antipattern name]: [how avoided]

**Trade-offs Resolved**:
- [Trade-off]: [choice made] - [rationale]

**Dependencies**:
- Depends on: [lego1, lego2]
- Depended on by: [lego3, lego4]

**Testing Strategy**:
- Unit tests: [scope]
- Integration tests: [scope]
- System tests: [scope]

---

## 3. Session Execution Plan

### 3.1 Session Hierarchy

```
Session 0: Meta-Orchestrator (CTO)
    ├── Session 1: config_validator (Tech Lead)
    ├── Session 2: auth (Tech Lead)
    ├── Session 3: database (Tech Lead)
    ├── Session 4: api_gateway (Tech Lead)
    └── ... (parallel LEGO orchestrators)
```

### 3.2 Execution Phases

**Phase 1: Configuration Validation** (Sequential, CRITICAL)
- Session 1: config_validator
  - Status: [PENDING | RUNNING | DONE | FAILED]
  - Expected duration: [estimate]
  - Failure count: 0

**Phase 2: Core Infrastructure** (Parallel after config validation)
- Session 2: auth
- Session 3: database
- Session 4: logging
  - All parallelizable (no inter-dependencies)

**Phase 3: Business Logic** (Parallel after Phase 2)
- Session 5: api_gateway (depends on auth)
- Session 6: user_service (depends on database)
- Session 7: report_generator (depends on database)

**Phase 4: Integration & System Tests** (Sequential after Phase 3)
- Integration test session
- System test session

**Phase 5: Documentation & Review** (Sequential after Phase 4)
- Final documentation
- System-level review

### 3.3 Session Isolation Strategy

- Each LEGO-Orchestrator runs in isolated session (3-5 tasks per session)
- State persisted in `lego_state_<name>.json`
- Session hygiene: exit after 3-5 substantial tasks
- Restartable: Meta-orchestrator relaunches sessions as needed

---

## 4. Risk & Confidence Assessment

### 4.1 High-Risk LEGOs

| LEGO | Risk Level | Rationale | Mitigation |
|------|-----------|-----------|------------|
| [name] | CRITICAL | Handles PII/payment data | Red-team review, security audit |
| [name] | HIGH | Auth/authorization logic | Extra validation, threat modeling |

### 4.2 Low-Confidence LEGOs

| LEGO | Confidence | Reason | Action |
|------|-----------|--------|--------|
| [name] | 0.45 | Unclear requirements | Human review before implementation |
| [name] | 0.60 | Novel architecture | Prototype first, then implement |

### 4.3 Critical Dependencies

**External APIs**:
- [API Name]: [purpose] - [free/paid] - [rate limits] - [env vars]

**External Services**:
- [Service Name]: [purpose] - [SLA requirements] - [circuit breaker needed?]

**Data Sensitivity**:
- PII: [YES/NO] - [what data, where stored]
- PHI: [YES/NO] - [HIPAA compliance needed?]
- Payment Data: [YES/NO] - [PCI-DSS compliance needed?]

---

## 5. Wisdom & Patterns Applied

### 5.1 Engineering Wisdom

- **Thompson #5**: "Do one thing well"
  - Applied to: All LEGOs (single responsibility)
  - Impact: Clear boundaries, easier testing

- **Knuth #2**: "Premature optimization is the root of all evil"
  - Applied to: [LEGO name]
  - Impact: Deferred optimization until profiling data available

- **[Additional principles]**

### 5.2 Strategic Wisdom

- **Sun Tzu #1**: "Know yourself and the enemy"
  - Applied to: Requirements discovery
  - Impact: Clarified constraints and risks early

- **Taleb #5**: "Barbell Strategy"
  - Applied to: [Decision]
  - Impact: Conservative for critical LEGOs, bold for experiments

- **[Additional principles]**

### 5.3 Antipatterns Detected & Avoided

- **God Object**: Initial design had "user_management" LEGO doing auth + sessions + logging
  - **Remedy**: Split into 3 LEGOs (auth, session, logging)
  - **Wisdom**: Thompson #5, LEGO Architecture pattern

- **Premature Optimization**: Considered implementing custom caching layer
  - **Remedy**: Deferred until performance bottleneck identified
  - **Wisdom**: Knuth #2

- **[Additional antipatterns]**

### 5.4 Trade-offs Resolved

| Trade-off | Choice | Rationale | Wisdom |
|-----------|--------|-----------|--------|
| SQL vs NoSQL | SQL | Structured data, ACID needed | Default from trade_off_matrix.md |
| Monolith vs Microservices | Monolith | Simplicity, small team | KISS principle, default |
| Sync vs Async | Sync | Simpler reasoning, no async needed yet | KISS principle, default |
| [Additional] | [Choice] | [Rationale] | [Wisdom] |

---

## 6. Testing Strategy

### 6.1 Unit Tests

**Coverage Target**: 80%+ for all implementation LEGOs

| LEGO | Test Scope | Edge Cases | Error Scenarios |
|------|-----------|------------|-----------------|
| auth | login, logout, token validation | expired tokens, malformed input | invalid credentials, DB unavailable |
| database | CRUD operations | empty results, large datasets | connection failures, constraint violations |
| [LEGO] | [scope] | [edge cases] | [errors] |

### 6.2 Integration Tests

**Scenarios**:
1. **Auth + Database**: User registration and login flow
2. **API Gateway + Auth + Database**: Protected endpoint access
3. **[Component A] + [Component B]**: [scenario]

### 6.3 System Tests

**End-to-End Flows**:
1. **Happy Path**: [User action] → [Expected result]
2. **Error Path**: [User action with invalid input] → [Error handling]
3. **Security Path**: [Unauthorized access attempt] → [Access denied]

**Non-Functional Tests**:
- Performance: [criteria]
- Security: [penetration testing, OWASP top 10]
- Reliability: [circuit breaker, retry logic]

---

## 7. Documentation Plan

### 7.1 User-Facing Documentation

- **README.md**: Installation, quickstart, usage examples
- **API.md**: API endpoints, request/response formats (if applicable)
- **CONFIGURATION.md**: Environment variables, config files, setup wizard

### 7.2 Developer Documentation

- **ARCHITECTURE.md**: High-level design, LEGO breakdown, rationale
- **CONTRIBUTING.md**: How to add features, testing guidelines
- **internal-notes.md**: Technical debt, trade-offs, future improvements

### 7.3 Operational Documentation

- **DEPLOYMENT.md**: Deployment steps, dependencies, infrastructure
- **MONITORING.md**: Metrics, alerts, debugging (if applicable)
- **RUNBOOK.md**: Common issues and solutions

---

## 8. Evaluation & Success Criteria

### 8.1 Functional Success

- ✅ All LEGOs implemented and passing unit tests
- ✅ Integration tests passing (all component interactions working)
- ✅ System tests passing (end-to-end flows working)
- ✅ Config validation guides user through setup successfully

### 8.2 Non-Functional Success

- ✅ Performance: [specific criteria, e.g., "API responds <200ms for 95% of requests"]
- ✅ Security: [criteria, e.g., "No OWASP top 10 vulnerabilities"]
- ✅ Reliability: [criteria, e.g., "Circuit breaker triggers on external API failures"]
- ✅ Simplicity (KISS): [criteria, e.g., "Each LEGO <300 LOC, clear single responsibility"]

### 8.3 Process Success

- ✅ No session exceeded context limits (session isolation working)
- ✅ All high-risk LEGOs underwent red-team review
- ✅ All low-confidence LEGOs (<0.5) reviewed by human before implementation
- ✅ Wisdom principles applied and documented in LEGO states

---

## 9. Known Limitations & Future Work

### 9.1 Current Limitations

- [Limitation 1]: [description] - [workaround or acceptance criteria]
- [Limitation 2]: [description] - [workaround or acceptance criteria]

### 9.2 Technical Debt

- [Debt Item 1]: [description] - [rationale for deferring] - [when to address]
- [Debt Item 2]: [description] - [rationale for deferring] - [when to address]

### 9.3 Future Enhancements

- [Enhancement 1]: [description] - [value] - [priority]
- [Enhancement 2]: [description] - [value] - [priority]

---

## 10. Execution Log

### Checkpoint 1: Requirements Discovery
- **Date**: [YYYY-MM-DD]
- **Status**: [COMPLETE | IN_PROGRESS]
- **Output**: requirements.md, dependencies.md, external_services.md
- **Issues**: [any blockers or clarifications needed]

### Checkpoint 2: LEGO Plan Approval
- **Date**: [YYYY-MM-DD]
- **Status**: [COMPLETE | IN_PROGRESS]
- **Output**: lego_plan.json, APP_ORCHESTRATION.md (this file)
- **User Approval**: [APPROVED | CHANGES_REQUESTED]
- **Issues**: [any plan modifications]

### Checkpoint 3: Implementation
- **Date**: [YYYY-MM-DD]
- **Status**: [COMPLETE | IN_PROGRESS]
- **LEGOs Completed**: [N / Total]
- **LEGOs In Progress**: [list]
- **LEGOs Blocked**: [list with reasons]
- **Issues**: [any failures or stuck steps]

### Checkpoint 4: Testing
- **Date**: [YYYY-MM-DD]
- **Status**: [COMPLETE | IN_PROGRESS]
- **Unit Tests**: [N passed / N total]
- **Integration Tests**: [N passed / N total]
- **System Tests**: [N passed / N total]
- **Issues**: [test failures or coverage gaps]

### Checkpoint 5: Documentation & Review
- **Date**: [YYYY-MM-DD]
- **Status**: [COMPLETE | IN_PROGRESS]
- **Documentation Complete**: [YES/NO]
- **Review Complete**: [YES/NO]
- **Issues**: [any gaps or improvements needed]

---

## 11. Final Approval

**Meta-Orchestrator Assessment**:
- Overall Confidence: [0.0 - 1.0]
- All Critical LEGOs: [VALIDATED | PENDING]
- Security Review: [COMPLETE | PENDING]
- Documentation: [COMPLETE | PENDING]

**Ready for Deployment**: [YES | NO | WITH_CAVEATS]

**Caveats** (if any):
- [Caveat 1]: [description and mitigation]
- [Caveat 2]: [description and mitigation]

**Human Review Recommended**: [YES | NO]
- Reason: [if YES, why]

---

**End of Application Orchestration Plan**

This document is generated by the meta-orchestrator and updated throughout the pipeline execution. It serves as the single source of truth for the app-specific orchestration strategy.
